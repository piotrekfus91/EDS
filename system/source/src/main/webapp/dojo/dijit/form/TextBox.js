/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["dijit.form.TextBox"]){dojo._hasResource["dijit.form.TextBox"]=true;dojo.provide("dijit.form.TextBox");dojo.require("dijit.form._FormWidget");dojo.declare("dijit.form.TextBox",dijit.form._FormValueWidget,{trim:false,uppercase:false,lowercase:false,propercase:false,maxLength:"",selectOnClick:false,delayOnChange:0,_timerOnChange:null,onDelayedChange:function(_1){},templateString:dojo.cache("dijit.form","templates/TextBox.html","<input class=\"dijit dijitReset dijitLeft\" dojoAttachPoint='textbox,focusNode'\n\tdojoAttachEvent='onmouseenter:_onMouse,onmouseleave:_onMouse'\n\tautocomplete=\"off\" type=\"${type}\" ${nameAttrSetting}\n\t/>\n"),baseClass:"dijitTextBox",attributeMap:dojo.delegate(dijit.form._FormValueWidget.prototype.attributeMap,{maxLength:"focusNode"}),_getValueAttr:function(){return this.parse(this.attr("displayedValue"),this.constraints);},_setValueAttr:function(_2,_3,_4){var _5;if(_2!==undefined){_5=this.filter(_2);if(typeof _4!="string"){if(_5!==null&&((typeof _5!="number")||!isNaN(_5))){_4=this.filter(this.format(_5,this.constraints));}else{_4="";}}}if(_4!=null&&_4!=undefined&&((typeof _4)!="number"||!isNaN(_4))&&this.textbox.value!=_4){this.textbox.value=_4;}this.inherited(arguments,[_5,_3]);},displayedValue:"",getDisplayedValue:function(){dojo.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use attr('displayedValue') instead.","","2.0");return this.attr("displayedValue");},_getDisplayedValueAttr:function(){return this.filter(this.textbox.value);},setDisplayedValue:function(_6){dojo.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use attr('displayedValue', ...) instead.","","2.0");this.attr("displayedValue",_6);},_setDisplayedValueAttr:function(_7){if(_7===null||_7===undefined){_7="";}else{if(typeof _7!="string"){_7=String(_7);}}this.textbox.value=_7;this._setValueAttr(this.attr("value"),undefined,_7);},format:function(_8,_9){return ((_8==null||_8==undefined)?"":(_8.toString?_8.toString():_8));},parse:function(_a,_b){return _a;},_refreshState:function(){},_onInput:function(e){if(e&&e.type&&/key/i.test(e.type)&&e.keyCode){switch(e.keyCode){case dojo.keys.SHIFT:case dojo.keys.ALT:case dojo.keys.CTRL:case dojo.keys.TAB:return;}}if(this.intermediateChanges){var _c=this;setTimeout(function(){_c._handleOnChange(_c.attr("value"),false);},0);}if(this.delayOnChange>0){if(this._timerOnChange){clearTimeout(this._timerOnChange);}this._timerOnChange=setTimeout(function(){_c._timerOnChange=null;_c.onDelayedChange(_c.attr("value"));},this.delayOnChange);}this._refreshState();},_onMouseDown:function(){this._selectOnUp=!this._focused&&!this.disabled&&!this.readOnly;},_onClick:function(){if(this._focused&&this._selectOnUp){var _d;if(dojo.isIE){var _e=dojo.doc.selection.createRange();var _f=_e.parentElement();_d=_f==this.textbox&&_e.text.length==0;}else{_d=this.textbox.selectionStart==this.textbox.selectionEnd;}if(_d){dijit.selectInputText(this.textbox);}}this._selectOnUp=false;},postCreate:function(){this.textbox.setAttribute("value",this.textbox.value);this.inherited(arguments);if(dojo.isMoz||dojo.isOpera){this.connect(this.textbox,"oninput",this._onInput);}else{this.connect(this.textbox,"onkeydown",this._onInput);this.connect(this.textbox,"onkeyup",this._onInput);this.connect(this.textbox,"onpaste",this._onInput);this.connect(this.textbox,"oncut",this._onInput);}if(this.selectOnClick){this.connect(this.textbox,"onmousedown",this._onMouseDown);this.connect(this.textbox,"onclick",this._onClick);}},_blankValue:"",filter:function(val){if(val===null){return this._blankValue;}if(typeof val!="string"){return val;}if(this.trim){val=dojo.trim(val);}if(this.uppercase){val=val.toUpperCase();}if(this.lowercase){val=val.toLowerCase();}if(this.propercase){val=val.replace(/[^\s]+/g,function(_10){return _10.substring(0,1).toUpperCase()+_10.substring(1);});}return val;},_setBlurValue:function(){this._setValueAttr(this.attr("value"),true);},_onBlur:function(e){if(this.disabled){return;}this._setBlurValue();this.inherited(arguments);if(this.selectOnClick&&dojo.isMoz){this.textbox.selectionStart=this.textbox.selectionEnd=undefined;}},_onFocus:function(e){if(this.disabled||this.readOnly){return;}this._refreshState();this.inherited(arguments);},reset:function(){this.textbox.value="";this.inherited(arguments);}});dijit.selectInputText=function(_11,_12,_13){var _14=dojo.global;var _15=dojo.doc;_11=dojo.byId(_11);if(isNaN(_12)){_12=0;}if(isNaN(_13)){_13=_11.value?_11.value.length:0;}dijit.focus(_11);if(_15["selection"]&&dojo.body()["createTextRange"]){if(_11.createTextRange){var _16=_11.createTextRange();with(_16){collapse(true);moveStart("character",-99999);moveStart("character",_12);moveEnd("character",_13-_12);select();}}}else{if(_14["getSelection"]){if(_11.setSelectionRange){_11.setSelectionRange(_12,_13);}}}};}